<html><style>body{font-family:monospace;}</style><body onload='document.body.innerHTML=g(f({".":"....O....","O":"OOOOOOOOO"},".",5))'><script>function f(r,s,i){for(j=i;j--;){var a=s.split('');for(k=a.length;k--;){a[k]=r[a[k]]}s=a.join('')}return s}function p(i){var n=1;while(i%Math.pow(3,n)==0){n++}return n-1}function g(s){var b='',m,n=0,d=Math.sqrt(s.length);var a=new Array(d);for(m=0;m<d;m++){a[m]=new Array(d)}m=0;a[0][0]=s.charAt(0);for(i=1;i<s.length;i++){var x,y,z=p(i);if(z>0){if(z%2==1){x=Math.pow(3,(z+1)/2);y=0}else{x=0;y=Math.pow(3,z/2)}x=-x+1;y=-y+1}else{x=1;y=0}m+=x;n+=y;a[m][n]=s.charAt(i)}for(m=0;m<d;m++){for(n=0;n<d;n++){b+=a[m][n];}b+='<br/>'}return b}</script></body></html>